import pandas as pd

# Load dataset
df = pd.read_csv(r"your path\Titanic-Dataset.csv")

def detect_column_types(df, categorical_threshold=20):
    column_types = {}
    for col in df.columns:
        dtype = df[col].dtype
        num_unique = df[col].nunique()

        # Text columns
        if dtype == 'object' or dtype == 'string':
            column_types[col] = 'text'

        # Numeric columns
        elif pd.api.types.is_numeric_dtype(df[col]):
            if num_unique < categorical_threshold:
                column_types[col] = 'categorical'
            else:
                column_types[col] = 'numerical'

        # Fallback
        else:
            column_types[col] = 'categorical'
    
    return column_types

# Call the function
result = detect_column_types(df)
print(result)

